<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:MauiXamlCsharpSample"
             x:Class="MauiXamlCsharpSample.MainPage"
             x:DataType="local:MainViewModel">

    <ScrollView>
        <VerticalStackLayout Padding="30" Spacing="20">

            <Label Text="XAML C# Expressions Demo" 
                   FontSize="24" 
                   FontAttributes="Bold"
                   HorizontalOptions="Center" />

            <!-- FEATURE 1: Simple Property Binding -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="1. Simple Property Binding: {Name}" FontAttributes="Bold" />
                    
                    <!-- NEW: C# Expression syntax (implicit - auto-detected) -->
                    <Entry Text="{Name}" Placeholder="Enter your name" />
                    <Label Text="{Name}" FontSize="18" />
                    
                    <!-- NEW: C# Expression syntax (explicit with = prefix) -->
                    <Label Text="{= Name}" FontSize="14" TextColor="Gray" />
                    
                    <!-- OLD: Traditional Binding syntax
                    <Entry Text="{Binding Name}" Placeholder="Enter your name" />
                    <Label Text="{Binding Name}" FontSize="18" />
                    -->
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 2: String Interpolation -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="2. String Interpolation" FontAttributes="Bold" />
                    
                    <!-- NEW: C# Expression with string interpolation -->
                    <Label Text="{$'Hello, {Name}!'}" FontSize="18" TextColor="DarkBlue" />
                    
                    <!-- OLD: Required StringFormat or a computed property in ViewModel
                    <Label Text="{Binding Name, StringFormat='Hello, {0}!'}" FontSize="18" TextColor="DarkBlue" />
                    -->
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 3: Multi-Root Expressions (Calculations) -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="3. Calculations: {Price * Quantity}" FontAttributes="Bold" />
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Price:" VerticalOptions="Center" />
                        <Stepper Value="{Price}" Minimum="1" Maximum="100" Increment="0.5" />
                        <Label Text="{$'${Price:F2}'}" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Quantity:" VerticalOptions="Center" />
                        <Stepper Value="{Quantity}" Minimum="1" Maximum="100" />
                        <Label Text="{$'{Quantity}'}" VerticalOptions="Center" />
                    </HorizontalStackLayout>
                    
                    <!-- NEW: C# Expression with calculation -->
                    <Label Text="{$'Total: ${Price * Quantity:F2}'}" FontSize="20" FontAttributes="Bold" TextColor="Green" />
                    
                    <!-- OLD: Required a computed property in ViewModel (e.g., Total) or MultiBinding with converter
                    <Label Text="{Binding Total, StringFormat='Total: ${0:F2}'}" FontSize="20" FontAttributes="Bold" TextColor="Green" />
                    
                    Or with MultiBinding:
                    <Label FontSize="20" FontAttributes="Bold" TextColor="Green">
                        <Label.Text>
                            <MultiBinding StringFormat="Total: ${0:F2}">
                                <Binding Path="Price" />
                                <Binding Path="Quantity" />
                                <MultiBinding.Converter>
                                    <local:MultiplyConverter />
                                </MultiBinding.Converter>
                            </MultiBinding>
                        </Label.Text>
                    </Label>
                    -->
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 4: Boolean Negation -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="4. Boolean Negation: {!IsHidden}" FontAttributes="Bold" />
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Is Hidden:" VerticalOptions="Center" />
                        <Switch IsToggled="{IsHidden}" />
                    </HorizontalStackLayout>
                    
                    <!-- NEW: C# Expression with boolean negation -->
                    <Label Text="This text is visible when NOT hidden" 
                           IsVisible="{!IsHidden}" 
                           TextColor="Purple"
                           FontSize="16" />
                    
                    <!-- OLD: Required a BooleanInvertConverter
                    <Label Text="This text is visible when NOT hidden" 
                           IsVisible="{Binding IsHidden, Converter={StaticResource BooleanInvertConverter}}" 
                           TextColor="Purple"
                           FontSize="16" />
                    
                    Plus in Resources:
                    <local:BooleanInvertConverter x:Key="BooleanInvertConverter" />
                    
                    Plus a converter class:
                    public class BooleanInvertConverter : IValueConverter { ... }
                    -->
                    
                    <Label Text="(No BooleanInvertConverter needed!)" 
                           FontSize="12" 
                           TextColor="Gray" />
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 5: Boolean Expressions -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="5. Boolean Expressions: {HasAccount &amp;&amp; AgreedToTerms}" FontAttributes="Bold" />
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Has Account:" VerticalOptions="Center" />
                        <Switch IsToggled="{HasAccount}" />
                    </HorizontalStackLayout>
                    <HorizontalStackLayout Spacing="10">
                        <Label Text="Agreed to Terms:" VerticalOptions="Center" />
                        <Switch IsToggled="{AgreedToTerms}" />
                    </HorizontalStackLayout>
                    
                    <!-- NEW: C# Expression with boolean AND -->
                    <Button Text="Submit" 
                            IsEnabled="{HasAccount &amp;&amp; AgreedToTerms}"
                            BackgroundColor="DarkGreen" 
                            TextColor="White" />
                    
                    <!-- OLD: Required MultiBinding with AllTrueConverter or a computed property
                    <Button Text="Submit" BackgroundColor="DarkGreen" TextColor="White">
                        <Button.IsEnabled>
                            <MultiBinding Converter="{StaticResource AllTrueConverter}">
                                <Binding Path="HasAccount" />
                                <Binding Path="AgreedToTerms" />
                            </MultiBinding>
                        </Button.IsEnabled>
                    </Button>
                    
                    Plus converter class:
                    public class AllTrueConverter : IMultiValueConverter { ... }
                    -->
                    
                    <Label Text="(No MultiBinding + AllTrueConverter needed!)" 
                           FontSize="12" 
                           TextColor="Gray" />
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 6: Lambda Event Handlers -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="6. Lambda Event Handlers" FontAttributes="Bold" />
                    
                    <!-- NEW: C# Expression with inline lambda (calling page method) -->
                    <Button Text="{$'Clicked {ClickCount} times'}" 
                            Clicked="{(s, e) => this.OnCounterClicked()}"
                            BackgroundColor="DarkOrange" 
                            TextColor="White" />
                    
                    <!-- NEW: C# Expression accessing ViewModel property directly -->
                    <Button Text="Increment via ViewModel" 
                            Clicked="{(s, e) => ViewModel.ClickCount++}"
                            BackgroundColor="Orange" 
                            TextColor="White" />
                    
                    <!-- NEW: C# Expression with cast to ViewModel -->
                    <Button Text="Increment via cast" 
                            Clicked="{(s, e) => ((MainViewModel)BindingContext).ClickCount++}"
                            BackgroundColor="DarkGoldenrod" 
                            TextColor="White" />
                    
                    <!-- OLD: Required code-behind event handler or Command
                    <Button Text="{Binding ClickCount, StringFormat='Clicked {0} times'}" 
                            Clicked="OnCounterClicked"
                            BackgroundColor="DarkOrange" 
                            TextColor="White" />
                    
                    Or with Command:
                    <Button Text="{Binding ClickCount, StringFormat='Clicked {0} times'}" 
                            Command="{Binding IncrementCommand}"
                            BackgroundColor="DarkOrange" 
                            TextColor="White" />
                    -->
                </VerticalStackLayout>
            </Border>

            <!-- FEATURE 7: Async Event Handlers -->
            <Border Stroke="Gray" Padding="15" StrokeShape="RoundRectangle 8">
                <VerticalStackLayout Spacing="10">
                    <Label Text="7. Async Event Handlers" FontAttributes="Bold" />
                    
                    <!-- NEW: C# Expression with async lambda -->
                    <Button Text="Save (Async)" 
                            Clicked="{async (s, e) => await SaveAsync()}"
                            BackgroundColor="DarkRed" 
                            TextColor="White" />
                    
                    <!-- OLD: Required code-behind async event handler or AsyncCommand
                    <Button Text="Save (Async)" 
                            Clicked="OnSaveClicked"
                            BackgroundColor="DarkRed" 
                            TextColor="White" />
                    
                    Plus in code-behind:
                    private async void OnSaveClicked(object sender, EventArgs e)
                    {
                        await SaveAsync();
                    }
                    
                    Or with AsyncCommand (from MVVM Toolkit):
                    <Button Text="Save (Async)" 
                            Command="{Binding SaveCommand}"
                            BackgroundColor="DarkRed" 
                            TextColor="White" />
                    -->
                    
                    <Label Text="{StatusMessage}" TextColor="DarkGreen" />
                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
